javascript:(function(){const k="AIzaSyCiOxDTIkB1NVkphtXESCX6jUrlFrTQu6A",u="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key="+k,tOut=12000,conc=2,sleep=m=>new Promise(r=>setTimeout(r,m));async function ask(q){try{const ctl=new AbortController,id=setTimeout(()=>ctl.abort(),tOut),r=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:"Responda SOMENTE o conteúdo exato. Para selects, retorne uma opção correta por linha.\n\n"+q}]}]}),signal:ctl.signal});clearTimeout(id);if(!r.ok)return"";const j=await r.json();return j?.candidates?.[0]?.content?.parts?.[0]?.text?.trim()||""}catch{return""}}const orig=new Map;function salvar(bl){if(orig.has(bl))return;const ed=bl.querySelector(".ql-editor");orig.set(bl,{texto:ed?ed.innerHTML:bl.innerText,selects:[...bl.querySelectorAll("select")].map(s=>s.value)})}function restaurar(){getQs().forEach(bl=>{const d=orig.get(bl);if(!d)return;const ed=bl.querySelector(".ql-editor");if(ed)ed.innerHTML=d.texto;bl.querySelectorAll("select").forEach((s,i)=>s.value=d.selects[i]||"")})}function aplicar(bl,res){if(!res)return;const linhas=res.split("\n").map(a=>a.trim()).filter(Boolean),sels=bl.querySelectorAll("select");if(sels.length){sels.forEach((sel,i)=>{const alvo=(linhas[i]||"").toLowerCase(),opts=[...sel.options];let o=opts.find(o=>o.text.trim().toLowerCase()===alvo)||opts.find(o=>o.text.trim().toLowerCase().includes(alvo))||opts.find(o=>o.text.trim().toLowerCase().startsWith(alvo));if(o)sel.value=o.value})}const ed=bl.querySelector(".ql-editor");if(ed)ed.innerHTML=res.replace(/\n/g,"<br>");else bl.innerText=res}async function workerize(tasks,cc=conc){let i=0;const ws=new Array(cc).fill(0).map(async()=>{while(i<tasks.length){const n=i++;try{await tasks[n]()}catch{}await sleep(120)}});await Promise.all(ws)}function getQs(){return[...document.querySelectorAll("[chavebase]")]}async function responderTudo(){const qs=getQs(),tasks=qs.map(bl=>async()=>{salvar(bl);const r=await ask(bl.innerText.trim());aplicar(bl,r)});await workerize(tasks)}async function responderSel(){const qs=getQs(),sel=[...document.querySelectorAll(".qSel:checked")].map(c=>+c.value),tasks=sel.map(i=>async()=>{const bl=qs[i];if(!bl)return;salvar(bl);const r=await ask(bl.innerText.trim());aplicar(bl,r)});await workerize(tasks)}function atualizarLista(){const l=document.getElementById("listaSel"),qs=getQs();if(!qs.length)return l.innerHTML="<i>Nenhuma questão</i>";l.innerHTML=qs.map((_,i)=>`<label style='display:block;margin:4px 0'><input class='qSel' type='checkbox' value='${i}'> Questão ${i+1}</label>`).join("")}function makeDragTransform(p){let x=0,y=0,sx=0,sy=0,drag=false;p.style.transform="translate(0px,0px)";p.addEventListener("mousedown",e=>{drag=true,sx=e.clientX,sy=e.clientY,p.style.transition="none"});document.addEventListener("mousemove",e=>{if(!drag)return;x+=e.clientX-sx;y+=e.clientY-sy;sx=e.clientX;sy=e.clientY;p.style.transform=`translate(${x}px,${y}px)`});document.addEventListener("mouseup",()=>{drag=false;p.style.transition="transform .05s linear"})}function criar(){if(document.getElementById("painelIA3"))return;const p=document.createElement("div");p.id="painelIA3";p.style="position:fixed;bottom:20px;right:20px;width:300px;padding:12px;background:rgba(20,20,20,.85);backdrop-filter:blur(8px);border-radius:12px;color:#fff;font-family:sans-serif;z-index:999999999;cursor:grab;";p.innerHTML=`<h3 style='margin:6px 0 10px;text-align:center'>Painel IA</h3><button id='btnTudo' style='width:100%;margin:4px 0;padding:7px'>Responder Tudo</button><button id='btnAtt' style='width:100%;margin:4px 0;padding:7px;background:#06f;color:#fff;border:0'>Atualizar Questões</button><div id='listaSel' style='margin:8px 0;padding:6px;border-radius:8px;background:rgba(0,0,0,.2);max-height:140px;overflow:auto'></div><button id='btnSel' style='width:100%;margin:4px 0;padding:7px'>Responder Selecionadas</button><button id='btnLimpar' style='width:100%;margin:4px 0;padding:7px;background:#a33;color:#fff;border:0'>Restaurar</button><button id='btnMin' style='width:100%;margin:4px 0;padding:7px;background:#333;color:#fff;border:0'>Minimizar</button>`;document.body.appendChild(p);makeDragTransform(p);const f=document.createElement("button");f.id="btnFloat";f.style="position:fixed;bottom:20px;right:20px;padding:12px;border-radius:50%;background:#0af;color:#000;border:none;z-index:999999999;display:none";f.textContent="IA";f.onclick=()=>{p.style.display="block";f.style.display="none"};document.body.appendChild(f);btnTudo.onclick=responderTudo;btnSel.onclick=responderSel;btnLimpar.onclick=restaurar;btnAtt.onclick=atualizarLista;btnMin.onclick=()=>{p.style.display="none";f.style.display="block"};atualizarLista()}addEventListener("keydown",e=>{if(e.key.toLowerCase()==="p"){const p=document.getElementById("painelIA3"),f=document.getElementById("btnFloat");if(!p)return;if(p.style.display==="none"){p.style.display="block";f.style.display="none"}else{p.style.display="none";f.style.display="none"}}if(e.key.toLowerCase()==="l")restaurar()});criar();})();
